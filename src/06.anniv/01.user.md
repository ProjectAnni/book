# 用户系统

`Anniv` 的用户系统分为注册、登录、删除三个部分。所有部分的 `body` 均为 `x-www-form-urlencoded`。

## 用户注册

用户注册的接口为 `/api/register`。用户的注册过程需要经历以下两个步骤：

### 步骤 1：获取注册信息

在用户实际填写注册表单之前，客户端需要了解服务端的配置信息。客户端通过 `GET /api/register` 获取 `Anniv` 注册部分的相关信息，可能的返回如下。

#### 403 Forbidden

当返回 403 时，表明站点**禁止注册**。客户端须准确地向用户传达该信息。

#### 200 OK

表明站点允许注册，同时服务端返回启用的用户注册特性列表，如下例：

```json
[
  "invite",
  {
    "name": "2fa",
    "value": "I3VFM3JKMNDJCDH5BMBEEQAW6KJ6NOE3"
  }
]
```

### 步骤 2：用户注册

在获取了站点信息后，就可以进行实际注册了。通过 `POST /api/register` 可以进行注册，需要的参数如下：

| 参数名   | 详情             |
| -------- | ---------------- |
| username | 用户名           |
| password | 密码             |
| email    | 邮箱             |
| nickname | 昵称             |
| avatar   | 头像链接         |
| 其他     | 各特性定义的参数 |

## 用户登录

用户登录的接口为 `/api/login`。用户的登录需要经历以下两个步骤。

### 步骤 1：获取登录信息

和注册一样，我们需要获取 `Anniv` 的登录特性信息。客户端通过 `GET /api/login` 获取登录信息，返回如下。

#### 200 OK

返回启用的用户登录特性列表，如下例：

```json
["2fa"]
```

### 步骤 2：用户实际登录

在得到登录特性列表后就可以实际登录了。通过 `POST /api/login` 进行登录，参数如下：

| 参数     | 详情             |
| -------- | ---------------- |
| email    | 邮箱             |
| password | 密码             |
| 其他     | 各特性定义的参数 |
