# Trait Backend

后端由 `trait Backend` 构成：

```rust
#[async_trait]
pub trait Backend {
    fn need_cache(&self) -> bool;

    fn has(&self, catalog: &str) -> bool;

    fn albums(&self) -> Vec<&str>;

    async fn update_albums(&mut self) -> Result<(), BackendError>;

    async fn get_audio(&self, catalog: &str, track_id: u8, track_name: &str) -> Result<Pin<Box<dyn AsyncRead>>, BackendError>;
}
```

其中　`need_cache` 用于标识后端的速度是否需要缓存；`has` 用于判断后端是否包含专辑；`albums` 用于获取所有可用的专辑 `catalog`。

`update_albums` 用来更新后端的专辑；而`get_audio` 则通过给定的 `catalog`、`track_id` 和 `track_name` 获取可 `Read` 的文件流。

由于后端和元数据仓库相互独立，因此后端本身无法通过查询的方式获得 `track_id` 对应的 `track_name`，因此需要手动提供。
